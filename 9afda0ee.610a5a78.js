(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{225:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"rightToc",(function(){return r})),n.d(t,"default",(function(){return s}));var a=n(1),o=n(9),i=(n(0),n(310)),c={id:"layout-api",title:"\u5e03\u5c40\u5f15\u64ce API",sidebar_label:"API"},r=[{value:"constructRoutes",id:"constructroutes",children:[]},{value:"constructApplications",id:"constructapplications",children:[]},{value:"constructLayoutEngine",id:"constructlayoutengine",children:[]},{value:"matchRoute",id:"matchroute",children:[]}],l={rightToc:r},p="wrapper";function s(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(i.b)(p,Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"single-spa-layout"),"\u5e93\u66b4\u9732\u4e86\u591a\u4e2ajavascript\u65b9\u6cd5\u4f5c\u4e3a\u516c\u5171API"),Object(i.b)("h2",{id:"constructroutes"},"constructRoutes"),Object(i.b)("p",null,"constructRoutes API\u5c06\u5e03\u5c40\u5b9a\u4e49\u8f6c\u6362\u4e3a\u4e0d\u900f\u660e\u7684\u201c\u5df2\u89e3\u6790\u8def\u7531\u201d\u5bf9\u8c61\u3002\u6211\u4eec\u79f0\u4e4b\u4e3a\u201c\u4e0d\u900f\u660e\u201d\uff0c\u56e0\u4e3a\u5f62\u72b6\u662f\u4e0d\u76f8\u5173\u7684\uff0c\u56e0\u4e3a\u60a8\u5c06\u53ea\u5728\u5355\u4e2aspa\u5e03\u5c40\u4e2d\u8c03\u7528\u5176\u4ed6API\u65f6\u4f7f\u7528\u5b83\u3002"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"import { constructRoutes } from 'single-spa-layout';\n\nconst htmlTemplate = document.querySelector('#single-spa-template')\nconst layoutData = {\n  props: {\n    authToken: \"78sf9d0fds89-0fysdiuf6sf8\",\n    loggedInUser: fetch('/api/user')\n  },\n  loaders: {\n    mainContent: `<img src=\"loading.gif\">`,\n    // A single-spa parcel config\n    topNav: singleSpaReact({...})\n  }\n};\n\nconst resolvedRoutes = constructRoutes(htmlTemplate, layoutData)\n")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"\u53c2\u6570")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"routesConfig")," (\u5fc5\u586b): Routes config \u662f\u4e00\u4e2a ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/layout-definition/#json-layouts"}),"JSON Layout \u5b9a\u4e49"),", \u4e00\u4e2a ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement"}),"HTMLElement"),", \u6216\u8005\u4e00\u4e2a",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/inikulin/parse5"}),"parse5 HTML element"),". \u5982\u679c\u4ed6\u662f\u4e00\u4e2aHTML\u5143\u7d20, \u4ed6\u5fc5\u987b\u662f\u4e00\u4e2a ",Object(i.b)("inlineCode",{parentName:"li"},"<single-spa-router>")," \u5143\u7d20\u6216\u8005\u4e00\u4e2a\u5305\u542b ",Object(i.b)("inlineCode",{parentName:"li"},"<single-spa-router>"),"\u6807\u7b7e\u7684",Object(i.b)("inlineCode",{parentName:"li"},"<template>"),"."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"layoutData")," (\u53ef\u9009): Layout data \u662f\u4e00\u4e2a\u53ef\u9009\u7684\u5bf9\u8c61\u5b83\u5b9a\u4e49\u4e86 ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/layout-definition/#props"}),"props")," \u548c\u4e3a",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/layout-definition/#html-layouts"}),"HTML Layouts"),"\u5b9a\u4e49\u7684",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/layout-definition/#props"}),"loaders"),". \u5982\u679c\u4f60\u4f7f\u7528",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/layout-definition/#json-layout"}),"JSON Layout"),"\u53ef\u4ee5\u7701\u7565\u6216\u8005\u4f60\u4e0d\u9700\u8981\u5728\u4f60\u7684HTML Layout\u91cc\u9762\u5b9a\u4e49props\u6216\u8005loaders\u3002layoutData\u5bf9\u8c61\u5e94\u8be5\u6709\u9876\u5c42\u5c5e\u6027",Object(i.b)("inlineCode",{parentName:"li"},"props"),"\u548c",Object(i.b)("inlineCode",{parentName:"li"},"loaders"),"\uff0c\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u7684\u4e3b\u952e\u7684prop\u548cloader\u548c\u5bf9\u5e94\u7684\u503c")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"\u8fd4\u56de\u503c")),Object(i.b)("p",null,"\u4e00\u4e2a\u4e0d\u900f\u660e",Object(i.b)("inlineCode",{parentName:"p"},"resolvedRoutes"),"\u5bf9\u8c61\u3002\u56e0\u4e3a\u5f53\u4f60\u8c03\u7528\u5176\u4ed6signle-spa-layout API\u53ea\u9700\u8981\u4f7f\u7528\u8fd9\u4e2a\u5bf9\u8c61\u5e76\u4e0d\u9700\u8981\u8bfb\u53d6\u8bfb\u53d6\u6216\u8005\u4fee\u6539\u8fd9\u4e2a",Object(i.b)("inlineCode",{parentName:"p"},"resolvedReroutes")),Object(i.b)("h2",{id:"constructapplications"},"constructApplications"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"constructApplications")," API \u5c06\u4f60\u7684",Object(i.b)("inlineCode",{parentName:"p"},"resolvedRoute"),"\u8f6c\u6362\u6210",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/configuration#registering-applications"}),"single-spa \u5e94\u7528\u6ce8\u518c\u5bf9\u8c61"),"\u3002\u8fd9\u4e2a\u5e94\u7528\u6ce8\u518c\u5bf9\u8c61\u7ecf\u5e38\u53bb\u8c03\u7528",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/api/#registerapplication"}),"singleSpa.registerApplication()"),"."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"import { constructRoutes, constructApplications } from 'single-spa-layout';\nimport { registerApplication } from 'single-spa';\n\nconst resolvedRoutes = constructRoutes(...)\nconst applications = constructApplications({\n  routes: resolvedRoutes,\n  loadApp: (app) => System.import(app.name)\n})\napplications.forEach(registerApplication);\n")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"\u53c2\u6570")),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"constructApplications")," \u63a5\u6536\u4e00\u4e2a\u5e26\u6709\u4e0b\u9762\u5c5e\u6027\u7684\u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"routes")," (\u5fc5\u586b): \u8fd9\u4e2a\u4e0d\u900f\u660e\u7684",Object(i.b)("inlineCode",{parentName:"li"},"resolvedRoutes"),"\u5bf9\u8c61\u8fd4\u56de",Object(i.b)("inlineCode",{parentName:"li"},"constructRoutes")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"loadApp")," (\u5fc5\u586b): \u662f\u4e00\u4e2a\u5e94\u7528\u5bf9\u8c61\u5e76\u4e14\u5fc5\u987b\u8fd4\u56de",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/configuration/#loading-function-or-application"}),"loading function"))),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"\u8fd4\u56de\u503c")),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"constructApplications")," \u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/configuration/#registering-applications"}),"single-spa registration objects"),"."),Object(i.b)("h2",{id:"constructlayoutengine"},"constructLayoutEngine"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"constructLayoutEngine")," API \u5c06",Object(i.b)("inlineCode",{parentName:"p"},"resolvedRoutes"),"\u548c",Object(i.b)("inlineCode",{parentName:"p"},"applications"),"\u8f6c\u6362\u6210\u4e00\u4e2a ",Object(i.b)("inlineCode",{parentName:"p"},"layoutEngine"),"\u5bf9\u8c61\u3002\u5e03\u5c40\u5f15\u64ce(layout engine)\u8d1f\u8d23\u521b\u5efa\uff0c\u9500\u6bc1\u548c\u518d\u8def\u7531\u8f6c\u6362\u8fc7\u7a0b\u4e2d\u91cd\u6392DOM\u5143\u7d20"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"import { constructRoutes, constructApplications, constructLayoutEngine } from 'single-spa-layout';\nimport { registerApplication, start } from 'single-spa';\n\nconst resolvedRoutes = constructRoutes(...);\nconst applications = constructApplications(...);\nconst layoutEngine = constructLayoutEngine({routes: resolvedRoutes, applications: applications});\n\nlayoutEngine.isActive(); // true\nlayoutEngine.deactivate();\nlayoutEngine.activate();\n\napplications.forEach(registerApplication);\nstart();\n")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"\u53c2\u6570")),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"constructLayoutEngine")," \u63a5\u6536\u4e00\u4e2a\u5e26\u6709\u4e0b\u9762\u5c5e\u6027\u7684\u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"routes")," (\u5fc5\u586b): \u4e00\u4e2a\u4e0d\u900f\u660e\u7684",Object(i.b)("inlineCode",{parentName:"li"},"resolvedRoutes"),"\u5bf9\u8c61\u4e0d\u8fd4\u56de",Object(i.b)("inlineCode",{parentName:"li"},"constructRoutes")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"applications")," (\u5fc5\u586b): \u4e00\u4e2a\u6570\u7ec4",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/configuration/#registering-applications"}),"application registration objects"),"\u8fd4\u56de",Object(i.b)("inlineCode",{parentName:"li"},"constructApplications")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"active")," (\u53ef\u9009): \u4e00\u4e2a\u5e03\u5c14\u578b\u6807\u5fd7\u662f\u5426\u542f\u52a8layout engine,\u9ed8\u8ba4\u662ftrue")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"\u8fd4\u56de\u503c")),Object(i.b)("p",null,"\u4e00\u4e2a\u5e26\u6709\u4e0b\u9762\u5c5e\u6027\u7684\u5bf9\u8c61",Object(i.b)("inlineCode",{parentName:"p"},"layoutEngine"),":"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"isActive"),": \u4e00\u4e2a\u4e0d\u5e26\u53c2\u6570\u7684\u51fd\u6570\u5e76\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u578b\u6807\u5fd7\u5f53\u524dlayout engine\u662f\u5426\u542f\u52a8\u3002\u5f53\u5904\u4e8e\u542f\u52a8\u72b6\u6001\uff0clayout engine\u5c06\u4f1a\u5728\u8def\u7531\u8f6c\u6362\u8fc7\u7a0b\u4e2d\u6539\u53d8DOM"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"activate"),":  \u4e00\u4e2a\u4e0d\u5e26\u53c2\u6570\u5e76\u8fd4\u56de",Object(i.b)("inlineCode",{parentName:"li"},"undefined"),".\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u542f\u52a8layout engine, \u5176\u4e2d\u5305\u542b\u4e86\u8def\u7531\u4e8b\u4ef6\u76d1\u542c\u4fbf\u4e8e\u5f15\u64ce\u4f1a\u5728\u8def\u7531\u8f6c\u6362\u8fc7\u7a0b\u4e2d\u6539\u53d8DOM"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"deactivate"),": \u4e00\u4e2a\u4e0d\u5e26\u53c2\u6570\u5e76\u8fd4\u56de",Object(i.b)("inlineCode",{parentName:"li"},"undefined"),"\u3002\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u505c\u6389layout engine,\u5176\u4e2d\u5305\u542b\u4e86\u505c\u6389\u6240\u6709\u8def\u7531\u4e8b\u4ef6\u76d1\u542c\u8fd9\u6837\u4fbf\u4e8elayout engine\u4e0d\u4f1a\u5728\u8def\u7531\u8f6c\u6362\u8fc7\u7a0b\u4e2d\u6539\u53d8DOM")),Object(i.b)("h2",{id:"matchroute"},"matchRoute"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"matchRoute")," API \u4e3b\u8981\u662f\u7528\u4e8e\u670d\u52a1\u7aef\u6e32\u67d3\u3002\u4ed6\u8fd4\u56de\u4e00\u4e2a\u8fc7\u6ee4\u540e\u7684",Object(i.b)("inlineCode",{parentName:"p"},"resolvedRoutes"),"\u5bf9\u8c61\uff0c\u5b83\u4ec5\u5305\u542b\u5339\u914d\u4e00\u4e2a\u7279\u6b8a\u8def\u5f84\u7684\u8def\u7531"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),'import { constructRoutes, matchRoute } from \'single-spa-layout\';\n\nconst resolvedRoutes = constructRoutes(...);\n\nconst settingsRoutes = matchRoute(resolvedRoutes, "/settings")\nconst dashboardRoutes = matchRoute(resolvedRoutes, "/dashboard")\n')),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"\u53c2\u6570")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"routes")," (\u5fc5\u586b): \u4ece",Object(i.b)("inlineCode",{parentName:"li"},"constructRoutes"),"\u8fd4\u56de\u4e00\u4e2a\u4e0d\u900f\u660e\u7684",Object(i.b)("inlineCode",{parentName:"li"},"resolvedRoutes")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"path")," (\u5fc5\u586b): \u4e00\u4e2a\u5339\u914d\u8def\u7531\u7684\u5b57\u7b26\u4e32\u8def\u5f84\u3002\u6ce8\u610f\u8fd9\u4e2a\u8def\u5f84\u4e0d\u662f\u4e00\u4e2aURL - \u5b83\u53ea\u662f\u4e00\u4e2a\u6d4f\u89c8\u5668URL\u7684\u8def\u5f84\u540d\u3002\u5728\u670d\u52a1\u7aef\u6e32\u67d3\u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528req.url")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"\u8fd4\u56de\u503c"),"\n\u4e00\u4e2a\u4e0d\u900f\u660e\u7684",Object(i.b)("inlineCode",{parentName:"p"},"resolvedRoutes"),"\u5bf9\u8c61\u3002\u56e0\u4e3a\u4f60\u53ea\u4f1a\u5728\u8c03\u7528\u5176\u4ed6single-spa-layout APIs\u7684\u65f6\u5019\u4f7f\u7528\u8fd9\u4e2a\u5bf9\u8c61\u5e76\u4e14\u4e0d\u9700\u8981\u8fdb\u884c\u8bfb\u53d6\u6216\u4fee\u6539",Object(i.b)("inlineCode",{parentName:"p"},"resolvedRoutes")))}s.isMDXComponent=!0},310:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return b}));var a=n(0),o=n.n(a),i=o.a.createContext({}),c=function(e){var t=o.a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):Object.assign({},t,e)),n},r=function(e){var t=c(e.components);return o.a.createElement(i.Provider,{value:t},e.children)};var l="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},s=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,r=e.parentName,l=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&-1===t.indexOf(a)&&(n[a]=e[a]);return n}(e,["components","mdxType","originalType","parentName"]),s=c(n),b=a,u=s[r+"."+b]||s[b]||p[b]||i;return n?o.a.createElement(u,Object.assign({},{ref:t},l,{components:n})):o.a.createElement(u,Object.assign({},{ref:t},l))}));function b(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,c=new Array(i);c[0]=s;var r={};for(var p in t)hasOwnProperty.call(t,p)&&(r[p]=t[p]);r.originalType=e,r[l]="string"==typeof e?e:a,c[1]=r;for(var b=2;b<i;b++)c[b]=n[b];return o.a.createElement.apply(null,c)}return o.a.createElement.apply(null,n)}s.displayName="MDXCreateElement"}}]);